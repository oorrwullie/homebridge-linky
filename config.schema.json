{
  "pluginAlias": "Linky",
  "pluginType": "platform",
  "singular": true,
  "headerDisplay": "Manage Linky API Server",
  "schema": {
    "type": "object",
    "properties": {
      "port": {
        "title": "API Server Port",
        "type": "number",
        "default": 8081,
        "minimum": 1,
        "maximum": 65535
      },
      "apiKey": {
        "title": "API Key",
        "type": "string",
        "description": "This key is required to authenticate API requests. Keep it secret!",
        "minLength": 32
      }
    },
    "required": ["port", "apiKey"]
  },
  "layout": [
    {
      "type": "flex",
      "flex-flow": "row wrap",
      "items": [
        "port",
        "apiKey"
      ]
    },
    {
      "type": "button",
      "title": "Regenerate API Key",
      "description": "Generate a new random API Key. You must update all clients after rotation!",
      "action": {
        "method": "POST",
        "url": "/rotate-key",
        "headers": {
          "x-linky-admin": "rotate-key-secret"
        },
        "successMessage": "API key rotated successfully. Please save the config!",
        "errorMessage": "Failed to rotate API key."
      },
      "confirm": {
        "title": "Rotate API Key?",
        "description": "This will immediately require all clients to update to a new API key."
      }
    }
  ]
}
